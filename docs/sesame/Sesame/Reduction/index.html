<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Reduction (sesame.Sesame.Reduction)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">sesame</a> &#x00BB; <a href="../index.html">Sesame</a> &#x00BB; Reduction</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Sesame.Reduction</span></code></h1><p>It implements the SESAME machine reduction rules, the main reduction loop and the Garbage Collection functions.</p><p>All functions in this module are O(1), unless stated otherwise.</p></header><div class="odoc-content"><p><code>reset</code> and <code>fresh</code> are used to generate fresh variable names (i.e. the pedixes used to distinguish the variables). Reset resets the internal counter by setting the index of the variable already used that has the largest index. <code>fresh</code> increments the counter.</p><div class="odoc-spec"><div class="spec value anchored" id="val-reset"><a href="#val-reset" class="anchor"></a><code><span><span class="keyword">val</span> reset : <span><span class="optlabel">?last_var</span>:int <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fresh"><a href="#val-fresh" class="anchor"></a><code><span><span class="keyword">val</span> fresh : <span>unit <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_exp"><a href="#val-is_exp" class="anchor"></a><code><span><span class="keyword">val</span> is_exp : <span><a href="../TermGraphs/index.html#type-value">TermGraphs.value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Returns <code>true</code> if the value in input is exponential</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enter_bo"><a href="#val-enter_bo" class="anchor"></a><code><span><span class="keyword">val</span> enter_bo : 
  <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-var">TermGraphs.var</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../TermGraphs/index.html#type-term">TermGraphs.term</a></span></code></div><div class="spec-doc"><p>Auxiliary function used during a <code>-o</code> step. <code>enter_bo bo ptr x t</code>, where <code>bo</code> is an abstraction body <code>[...]...[...]v</code> pointed by <code>ptr</code>, turns the graph pointed by <code>ptr</code> in place to <code>[...]...[...][v-x]t</code> The function takes O(n) time where n is the length of the context <code>[...]...[...]</code>.</p></div></div><p>The following set of functions are used to copy in linear time a subgraph. They are called by the <code>alpha</code> function that is used in the <code>-o</code> step. Some of them take in input the optional pointer to the subgraph to be copied, in order to create the backpointers during the copy.</p><div class="odoc-spec"><div class="spec value anchored" id="val-copy_value"><a href="#val-copy_value" class="anchor"></a><code><span><span class="keyword">val</span> copy_value : <span><a href="../TermGraphs/index.html#type-value">TermGraphs.value</a> <span class="arrow">&#45;&gt;</span></span> <a href="../TermGraphs/index.html#type-value">TermGraphs.value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_term"><a href="#val-copy_term" class="anchor"></a><code><span><span class="keyword">val</span> copy_term : <span><span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> option</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span> <a href="../TermGraphs/index.html#type-term">TermGraphs.term</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_var"><a href="#val-copy_var" class="anchor"></a><code><span><span class="keyword">val</span> copy_var : <span><span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> option</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-var">TermGraphs.var</a> <span class="arrow">&#45;&gt;</span></span> <a href="../TermGraphs/index.html#type-var">TermGraphs.var</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_bvar"><a href="#val-copy_bvar" class="anchor"></a><code><span><span class="keyword">val</span> copy_bvar : <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-bvar">TermGraphs.bvar</a> <span class="arrow">&#45;&gt;</span></span> <a href="../TermGraphs/index.html#type-bvar">TermGraphs.bvar</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-alpha"><a href="#val-alpha" class="anchor"></a><code><span><span class="keyword">val</span> alpha : 
  <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-var">TermGraphs.var</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../TermGraphs/index.html#type-term">TermGraphs.term</a></span></code></div><div class="spec-doc"><p><code>alpha bo ptr x t</code> implements at once alpha-conversion, i.e. subgraph copy, and subgraph alteration as needed to implement the -o rule. <code>bo</code> must be a term <code>...</code>...<code>...</code>v that is the context of an exponential box, and <code>ptr</code> a pointer to it. The function builds a renaming/copy <code>[...]'...[...]'v'</code> of <code>[...]...[...]v</code> and it returns <code>[...]'...[...]'[v'-x]t</code>. The function takes linear time in the size of <code>[...]...[...]v</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-drop_multiplicative_cut"><a href="#val-drop_multiplicative_cut" class="anchor"></a><code><span><span class="keyword">val</span> drop_multiplicative_cut : 
  <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a></span></code></div><div class="spec-doc"><p><code>drop_multiplicative_cut ptr p</code> (drops) a multiplicative cut, i.e. changes the subgraph <code>[v-m]t</code> pointed by <code>ptr</code> into <code>t</code>. The function also maps the additional pointer <code>p</code>, that could point to <code>t</code> inside <code>[v-m]t</code>, to reflect the cancellation of the cut.</p><ul><li>the first pointer must point to a <code>Bind</code> binding a multiplicative cut to be dropped</li><li>the return pointer is meant to be identical to the second pointer; however, if the second pointer was pointing inside the <code>Bind</code> pointed by the first pointer, than the return pointer is updated to be the first pointer</li></ul></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Clash"><a href="#exception-Clash" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Clash</span></span></code></div><div class="spec-doc"><p>Clash is raised at run time by the SESAME when there is a clash during reduction (e.g. a multiplicative value is found when an exponential value was expected)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-step"><a href="#val-step" class="anchor"></a><code><span><span class="keyword">val</span> step : <span><a href="../TermGraphs/index.html#type-pool">TermGraphs.pool</a> <span class="arrow">&#45;&gt;</span></span> string * <a href="../TermGraphs/index.html#type-pool">TermGraphs.pool</a></span></code></div><div class="spec-doc"><p>Implements a single SESAME machine step by acting on the first job of the pool in input. It modifies in place the term graph and it returns the new pool and the name of the reduction rule used (e.g. &quot;axmâ‚‚&quot;).</p><p>The computational cost of each step is either constant or linear in the size of unevaluted copies of values that occur in the initial term.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-steps"><a href="#val-steps" class="anchor"></a><code><span><span class="keyword">val</span> steps : <span><span class="label">pp</span>:<span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-pool">TermGraphs.pool</a> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-pool">TermGraphs.pool</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Main SESAME loop: it repeats single steps until the empty pool is reached. It takes in input a pretty printing function to print the new machine state after each step. The pretty printing function takes in input the name of the rule used and the new pool.</p></div></div><p>The next two functions implement garbage collection over normal forms by rewriting the term graph in place. They run in time linear in the size of the input. <code>gc_term</code> also takes in input the pointer to the term to be garbage collected.</p><div class="odoc-spec"><div class="spec value anchored" id="val-gc_value"><a href="#val-gc_value" class="anchor"></a><code><span><span class="keyword">val</span> gc_value : <span><a href="../TermGraphs/index.html#type-value">TermGraphs.value</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gc_term"><a href="#val-gc_term" class="anchor"></a><code><span><span class="keyword">val</span> gc_term : <span><a href="../TermGraphs/index.html#type-ptr">TermGraphs.ptr</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-eval"><a href="#val-eval" class="anchor"></a><code><span><span class="keyword">val</span> eval : <span><a href="../TermGraphs/index.html#type-term">TermGraphs.term</a> <span class="arrow">&#45;&gt;</span></span> <a href="../TermGraphs/index.html#type-term">TermGraphs.term</a></span></code></div><div class="spec-doc"><p>Entry point for term evaluation. It takes in input a term, it builds the initial SESAME state, it calls the main SESAME loop, followed by garbage collection. The final garbage free normal form is returned.</p></div></div></div></body></html>
